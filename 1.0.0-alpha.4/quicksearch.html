<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"node_modules_js-data-adapter_src_index.js.html":{"id":"node_modules_js-data-adapter_src_index.js.html","title":"Source: node_modules/js-data-adapter/src/index.js","body":" js-data-mongodb Classes AdapterMongoDBAdapter Global Global Source: node_modules/js-data-adapter/src/index.js import {utils} from 'js-data' const { addHiddenPropsToTarget, extend, fillIn, get, isArray, isObject, isUndefined, plainCopy, resolve } = utils export const reserved = [ 'orderBy', 'sort', 'limit', 'offset', 'skip', 'where' ] const noop = function (...args) { const self = this const opts = args[args.length - 1] self.dbg(opts.op, ...args) return resolve() } const noop2 = function (...args) { const self = this const opts = args[args.length - 2] self.dbg(opts.op, ...args) return resolve() } const DEFAULTS = { /** * Whether to log debugging information. * * @name Adapter#debug * @type {boolean} * @default false */ debug: false, /** * Whether to return a more detailed response object. * * @name Adapter#raw * @type {boolean} * @default false */ raw: false } /** * Response object used when `raw` is `true`. May contain other fields in * addition to `data`. * * @typedef {Object} Response * @property {Object} data Response data. * @property {string} op The operation for which the response was created. */ export function Response (data, meta, op) { const self = this self.data = data fillIn(self, meta) self.op = op } /** * Abstract class meant to be extended by adapters. * * @class Adapter * @abstract * @param {Object} [opts] Configuration opts. * @param {boolean} [opts.debug=false] Whether to log debugging information. * @param {boolean} [opts.raw=false] Whether to return a more detailed response * object. */ export default function Adapter (opts) { const self = this opts || (opts = {}) fillIn(opts, DEFAULTS) fillIn(self, opts) } /** * Alternative to ES6 class syntax for extending `Adapter`. * * @name Adapter.extend * @method * @param {Object} [instanceProps] Properties that will be added to the * prototype of the subclass. * @param {Object} [classProps] Properties that will be added as static * properties to the subclass itself. * @return {Object} Subclass of `Adapter`. */ Adapter.extend = extend addHiddenPropsToTarget(Adapter.prototype, { /** * Lifecycle method method called by &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the created record. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * * @name Adapter#afterCreate * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * @param {Object} props The `props` argument passed to &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * @property {string} opts.op `afterCreate` * @param {Object|Response} response Created record or {@link Response}, depending on the value of `opts.raw`. */ afterCreate: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the created records. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * * @name Adapter#afterCreate * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * @param {Object[]} props The `props` argument passed to &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * @property {string} opts.op `afterCreateMany` * @param {Object[]|Response} response Created records or {@link Response}, depending on the value of `opts.raw`. */ afterCreateMany: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be `undefined`. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * * @name Adapter#afterDestroy * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * @param {(string|number)} id The `id` argument passed to &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * @property {string} opts.op `afterDestroy` * @param {undefined|Response} response `undefined` or {@link Response}, depending on the value of `opts.raw`. */ afterDestroy: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be `undefined`. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * * @name Adapter#afterDestroyAll * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * @param {Object} query The `query` argument passed to &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * @property {string} opts.op `afterDestroyAll` * @param {undefined|Response} response `undefined` or {@link Response}, depending on the value of `opts.raw`. */ afterDestroyAll: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the found record, if any. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * * @name Adapter#afterFind * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * @param {(string|number)} id The `id` argument passed to &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * @property {string} opts.op `afterFind` * @param {Object|Response} response The found record or {@link Response}, depending on the value of `opts.raw`. */ afterFind: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the found records, if any. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * * @name Adapter#afterFindAll * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * @param {Object} query The `query` argument passed to &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * @property {string} opts.op `afterFindAll` * @param {Object[]|Response} response The found records or {@link Response}, depending on the value of `opts.raw`. */ afterFindAll: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated record. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * * @name Adapter#afterUpdate * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @param {(string|number)} id The `id` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @param {Object} props The `props` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @property {string} opts.op `afterUpdate` * @param {Object|Response} response The updated record or {@link Response}, depending on the value of `opts.raw`. */ afterUpdate: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated records, if any. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * * @name Adapter#afterUpdateAll * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @param {Object} props The `props` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @param {Object} query The `query` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @property {string} opts.op `afterUpdateAll` * @param {Object[]|Response} response The updated records or {@link Response}, depending on the value of `opts.raw`. */ afterUpdateAll: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt; to wait for the Promise to resolve before continuing. * * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated records, if any. * * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * * @name Adapter#afterUpdateMany * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * @param {Object[]} records The `records` argument passed to &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * @property {string} opts.op `afterUpdateMany` * @param {Object[]|Response} response The updated records or {@link Response}, depending on the value of `opts.raw`. */ afterUpdateMany: noop2, /** * Lifecycle method method called by &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt; to wait for the Promise to resolve before continuing. * * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * * @name Adapter#beforeCreate * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * @param {Object} props The `props` argument passed to &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#create__anchor&quot;&gt;create&lt;/a&gt;. * @property {string} opts.op `beforeCreate` */ beforeCreate: noop, /** * Lifecycle method method called by &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt; to wait for the Promise to resolve before continuing. * * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * * @name Adapter#beforeCreateMany * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * @param {Object[]} props The `props` argument passed to &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#createMany__anchor&quot;&gt;createMany&lt;/a&gt;. * @property {string} opts.op `beforeCreateMany` */ beforeCreateMany: noop, /** * Lifecycle method method called by &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt; to wait for the Promise to resolve before continuing. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * * @name Adapter#beforeDestroy * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * @param {(string|number)} id The `id` argument passed to &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#destroy__anchor&quot;&gt;destroy&lt;/a&gt;. * @property {string} opts.op `beforeDestroy` */ beforeDestroy: noop, /** * Lifecycle method method called by &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt; to wait for the Promise to resolve before continuing. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * * @name Adapter#beforeDestroyAll * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * @param {Object} query The `query` argument passed to &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#destroyAll__anchor&quot;&gt;destroyAll&lt;/a&gt;. * @property {string} opts.op `beforeDestroyAll` */ beforeDestroyAll: noop, /** * Lifecycle method method called by &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt; to wait for the Promise to resolve before continuing. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * * @name Adapter#beforeFind * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * @param {(string|number)} id The `id` argument passed to &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#find__anchor&quot;&gt;find&lt;/a&gt;. * @property {string} opts.op `beforeFind` */ beforeFind: noop, /** * Lifecycle method method called by &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt; to wait for the Promise to resolve before continuing. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * * @name Adapter#beforeFindAll * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * @param {Object} query The `query` argument passed to &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#findAll__anchor&quot;&gt;findAll&lt;/a&gt;. * @property {string} opts.op `beforeFindAll` */ beforeFindAll: noop, /** * Lifecycle method method called by &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt; to wait for the Promise to resolve before continuing. * * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * * @name Adapter#beforeUpdate * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @param {(string|number)} id The `id` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @param {Object} props The `props` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#update__anchor&quot;&gt;update&lt;/a&gt;. * @property {string} opts.op `beforeUpdate` */ beforeUpdate: noop, /** * Lifecycle method method called by &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt; to wait for the Promise to resolve before continuing. * * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * * @name Adapter#beforeUpdateAll * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @param {Object} props The `props` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @param {Object} query The `query` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#updateAll__anchor&quot;&gt;updateAll&lt;/a&gt;. * @property {string} opts.op `beforeUpdateAll` */ beforeUpdateAll: noop, /** * Lifecycle method method called by &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * * Override this method to add custom behavior for this lifecycle hook. * * Returning a Promise causes &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt; to wait for the Promise to resolve before continuing. * * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value. * * A thrown error or rejected Promise will bubble up and reject the Promise returned by &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * * @name Adapter#beforeUpdateMany * @method * @param {Object} mapper The `mapper` argument passed to &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * @param {Object[]} props The `props` argument passed to &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * @param {Object} opts The `opts` argument passed to &lt;a href=&quot;#updateMany__anchor&quot;&gt;updateMany&lt;/a&gt;. * @property {string} opts.op `beforeUpdateMany` */ beforeUpdateMany: noop, /** * Shortcut for `#log('debug'[, arg1[, arg2[, argn]]])`. * * @name Adapter#dbg * @method */ dbg (...args) { this.log('debug', ...args) }, /** * Create a new record. Called by `Mapper#create`. * * @name Adapter#create * @method * @param {Object} mapper The mapper. * @param {Object} props The record to be created. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ create (mapper, props, opts) { throw new Error('Not supported!') }, /** * Create multiple records in a single batch. Called by `Mapper#createMany`. * * @name Adapter#createMany * @method * @param {Object} mapper The mapper. * @param {Object} props The records to be created. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ createMany (mapper, props, opts) { throw new Error('Not supported!') }, /** * Destroy the record with the given primary key. Called by * `Mapper#destroy`. * * @name Adapter#destroy * @method * @param {Object} mapper The mapper. * @param {(string|number)} id Primary key of the record to destroy. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ destroy (mapper, id, opts) { throw new Error('Not supported!') }, /** * Destroy the records that match the selection query. Called by * `Mapper#destroyAll`. * * @name Adapter#destroyAll * @method * @param {Object} mapper the mapper. * @param {Object} [query] Selection query. * @param {Object} [query.where] Filtering criteria. * @param {string|Array} [query.orderBy] Sorting criteria. * @param {string|Array} [query.sort] Same as `query.sort`. * @param {number} [query.limit] Limit results. * @param {number} [query.skip] Offset results. * @param {number} [query.offset] Same as `query.skip`. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ destroyAll (mapper, query, opts) { throw new Error('Not supported!') }, /** * Return the foreignKey from the given record for the provided relationship. * * There may be reasons why you may want to override this method, like when * the id of the parent doesn't exactly match up to the key on the child. * * Override with care. * * @name Adapter#makeHasManyForeignKey * @method * @return {*} */ makeHasManyForeignKey (mapper, def, record) { return def.getForeignKey(record) }, /** * Return the foreignKeys from the given record for the provided relationship. * * Override with care. * * @name Adapter#makeHasManyForeignKeys * @method * @return {*} */ makeHasManyForeignKeys (mapper, def, record) { return get(record, mapper.idAttribute) }, /** * Load a hasMany relationship. * * Override with care. * * @name Adapter#loadHasMany * @method * @return {Promise} */ loadHasMany (mapper, def, records, __opts) { const self = this let singular = false if (isObject(records) &amp;&amp; !isArray(records)) { singular = true records = [records] } const IDs = records.map(function (record) { return self.makeHasManyForeignKey(mapper, def, record) }) const query = {} const criteria = query[def.foreignKey] = {} if (singular) { // more efficient query when we only have one record criteria['=='] = IDs[0] } else { criteria['in'] = IDs.filter(function (id) { return id }) } return self.findAll(def.getRelation(), query, __opts).then(function (relatedItems) { records.forEach(function (record) { let attached = [] // avoid unneccesary iteration when we only have one record if (singular) { attached = relatedItems } else { relatedItems.forEach(function (relatedItem) { if (get(relatedItem, def.foreignKey) === record[mapper.idAttribute]) { attached.push(relatedItem) } }) } def.setLocalField(record, attached) }) }) }, /** * Load a hasOne relationship. * * Override with care. * * @name Adapter#loadHasOne * @method * @return {Promise} */ loadHasOne (mapper, def, records, __opts) { if (isObject(records) &amp;&amp; !isArray(records)) { records = [records] } return this.loadHasMany(mapper, def, records, __opts).then(function () { records.forEach(function (record) { const relatedData = def.getLocalField(record) if (isArray(relatedData) &amp;&amp; relatedData.length) { def.setLocalField(record, relatedData[0]) } }) }) }, /** * Return the foreignKey from the given record for the provided relationship. * * Override with care. * * @name Adapter#makeBelongsToForeignKey * @method * @return {*} */ makeBelongsToForeignKey (mapper, def, record) { return def.getForeignKey(record) }, /** * Load a belongsTo relationship. * * Override with care. * * @name Adapter#loadBelongsTo * @method * @return {Promise} */ loadBelongsTo (mapper, def, records, __opts) { const self = this const relationDef = def.getRelation() if (isObject(records) &amp;&amp; !isArray(records)) { const record = records return self.find(relationDef, self.makeBelongsToForeignKey(mapper, def, record), __opts).then(function (relatedItem) { def.setLocalField(record, relatedItem) }) } else { const keys = records.map(function (record) { return self.makeBelongsToForeignKey(mapper, def, record) }).filter(function (key) { return key }) return self.findAll(relationDef, { where: { [relationDef.idAttribute]: { 'in': keys } } }, __opts).then(function (relatedItems) { records.forEach(function (record) { relatedItems.forEach(function (relatedItem) { if (relatedItem[relationDef.idAttribute] === record[def.foreignKey]) { def.setLocalField(record, relatedItem) } }) }) }) } }, /** * Retrieve the record with the given primary key. Called by `Mapper#find`. * * @name Adapter#find * @method * @param {Object} mapper The mapper. * @param {(string|number)} id Primary key of the record to retrieve. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {string[]} [opts.with=[]] Relations to eager load. * @return {Promise} */ find (mapper, id, opts) { throw new Error('Not supported!') }, /** * Retrieve the records that match the selection query. * * @name Adapter#findAll * @method * @param {Object} mapper The mapper. * @param {Object} [query] Selection query. * @param {Object} [query.where] Filtering criteria. * @param {string|Array} [query.orderBy] Sorting criteria. * @param {string|Array} [query.sort] Same as `query.sort`. * @param {number} [query.limit] Limit results. * @param {number} [query.skip] Offset results. * @param {number} [query.offset] Same as `query.skip`. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {string[]} [opts.with=[]] Relations to eager load. * @return {Promise} */ findAll (mapper, query, opts) { throw new Error('Not supported!') }, /** * Resolve the value of the specified option based on the given options and * this adapter's settings. Override with care. * * @name Adapter#getOpt * @method * @param {string} opt The name of the option. * @param {Object} [opts] Configuration options. * @return {*} The value of the specified option. */ getOpt (opt, opts) { opts || (opts = {}) return isUndefined(opts[opt]) ? plainCopy(this[opt]) : plainCopy(opts[opt]) }, /** * Logging utility method. Override this method if you want to send log * messages to something other than the console. * * @name Adapter#log * @method * @param {string} level Log level. * @param {...*} values Values to log. */ log (level, ...args) { if (level &amp;&amp; !args.length) { args.push(level) level = 'debug' } if (level === 'debug' &amp;&amp; !this.debug) { return } const prefix = `${level.toUpperCase()}: (Adapter)` if (console[level]) { console[level](prefix, ...args) } else { console.log(prefix, ...args) } }, /** * @name Adapter#respond * @method * @param {Object} response Response object. * @param {Object} opts Configuration options. * return {Object} If `opts.raw == true` then return `response`, else return * `response.data`. */ respond (response, opts) { return this.getOpt('raw', opts) ? response : response.data }, /** * Apply the given update to the record with the specified primary key. Called * by `Mapper#update`. * * @name Adapter#update * @method * @param {Object} mapper The mapper. * @param {(string|number)} id The primary key of the record to be updated. * @param {Object} props The update to apply to the record. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ update (mapper, id, props, opts) { throw new Error('Not supported!') }, /** * Apply the given update to all records that match the selection query. * Called by `Mapper#updateAll`. * * @name Adapter#updateAll * @method * @param {Object} mapper The mapper. * @param {Object} props The update to apply to the selected records. * @param {Object} [query] Selection query. * @param {Object} [query.where] Filtering criteria. * @param {string|Array} [query.orderBy] Sorting criteria. * @param {string|Array} [query.sort] Same as `query.sort`. * @param {number} [query.limit] Limit results. * @param {number} [query.skip] Offset results. * @param {number} [query.offset] Same as `query.skip`. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ updateAll (mapper, props, query, opts) { throw new Error('Not supported!') }, /** * Update the given records in a single batch. Called by `Mapper#updateMany`. * * @name Adapter#updateMany * @method * @param {Object} mapper The mapper. * @param {Object[]} records The records to update. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ updateMany (mapper, records, opts) { throw new Error('Not supported!') } }) × Search results Close Back to js-data.io "},"src_index.js.html":{"id":"src_index.js.html","title":"Source: src/index.js","body":" js-data-mongodb Classes AdapterMongoDBAdapter Global Global Source: src/index.js import {MongoClient} from 'mongodb' import {ObjectID} from 'bson' import {utils} from 'js-data' import Adapter from 'js-data-adapter' import { reserved, Response } from 'js-data-adapter' import underscore from 'mout/string/underscore' import unique from 'mout/array/unique' const { addHiddenPropsToTarget, classCallCheck, extend, fillIn, forEachRelation, forOwn, get, isArray, isObject, isString, isUndefined, omit, plainCopy, resolve } = utils const withoutRelations = function (mapper, props) { return omit(props, mapper.relationFields || []) } const DEFAULTS = { /** * Convert ObjectIDs to strings when pulling records out of the database. * * @name MongoDBAdapter#translateId * @type {boolean} * @default true */ translateId: true, /** * MongoDB URI. * * @name MongoDBAdapter#uri * @type {string} * @default mongodb://localhost:27017 */ uri: 'mongodb://localhost:27017' } const FIND_OPTS_DEFAULTS = {} const FIND_ONE_OPTS_DEFAULTS = {} const INSERT_OPTS_DEFAULTS = {} const INSERT_MANY_OPTS_DEFAULTS = {} const UPDATE_OPTS_DEFAULTS = {} const REMOVE_OPTS_DEFAULTS = {} /** * MongoDBAdapter class. * * @example * // Use Container instead of DataStore on the server * import {Container} from 'js-data' * import MongoDBAdapter from 'js-data-mongodb' * * // Create a store to hold your Mappers * const store = new Container({ * mapperDefaults: { * // MongoDB uses &quot;_id&quot; as the primary key * idAttribute: '_id' * } * }) * * // Create an instance of MongoDBAdapter with default settings * const adapter = new MongoDBAdapter() * * // Mappers in &quot;store&quot; will use the MongoDB adapter by default * store.registerAdapter('mongodb', adapter, { default: true }) * * // Create a Mapper that maps to a &quot;user&quot; collection * store.defineMapper('user') * * @class MongoDBAdapter * @extends Adapter * @param {Object} [opts] Configuration opts. * @param {boolean} [opts.debug=false] Whether to log debugging information. * @param {Object} [opts.findOpts] Options to pass to collection#find. * @param {Object} [opts.findOneOpts] Options to pass to collection#findOne. * @param {Object} [opts.insertOpts] Options to pass to collection#insert. * @param {Object} [opts.insertManyOpts] Options to pass to * collection#insertMany. * @param {boolean} [opts.raw=false] Whether to return detailed result objects * instead of just record data. * @param {Object} [opts.removeOpts] Options to pass to collection#remove. * @param {boolean} [opts.translateId=true] Convert ObjectIDs to strings when * pulling records out of the database. * @param {Object} [opts.updateOpts] Options to pass to collection#update. * @param {string} [opts.uri=&quot;mongodb://localhost:27017&quot;] MongoDB URI. */ export default function MongoDBAdapter (opts) { const self = this classCallCheck(self, MongoDBAdapter) opts || (opts = {}) if (isString(opts)) { opts = { uri: opts } } fillIn(opts, DEFAULTS) Adapter.call(self, opts) /** * Default options to pass to collection#find. * * @name MongoDBAdapter#findOpts * @type {Object} * @default {} */ self.findOpts || (self.findOpts = {}) fillIn(self.findOpts, FIND_OPTS_DEFAULTS) /** * Default options to pass to collection#findOne. * * @name MongoDBAdapter#findOneOpts * @type {Object} * @default {} */ self.findOneOpts || (self.findOneOpts = {}) fillIn(self.findOneOpts, FIND_ONE_OPTS_DEFAULTS) /** * Default options to pass to collection#insert. * * @name MongoDBAdapter#insertOpts * @type {Object} * @default {} */ self.insertOpts || (self.insertOpts = {}) fillIn(self.insertOpts, INSERT_OPTS_DEFAULTS) /** * Default options to pass to collection#insertMany. * * @name MongoDBAdapter#insertManyOpts * @type {Object} * @default {} */ self.insertManyOpts || (self.insertManyOpts = {}) fillIn(self.insertManyOpts, INSERT_MANY_OPTS_DEFAULTS) /** * Default options to pass to collection#update. * * @name MongoDBAdapter#updateOpts * @type {Object} * @default {} */ self.updateOpts || (self.updateOpts = {}) fillIn(self.updateOpts, UPDATE_OPTS_DEFAULTS) /** * Default options to pass to collection#update. * * @name MongoDBAdapter#removeOpts * @type {Object} * @default {} */ self.removeOpts || (self.removeOpts = {}) fillIn(self.removeOpts, REMOVE_OPTS_DEFAULTS) /** * A Promise that resolves to a reference to the MongoDB client being used by * this adapter. * * @name MongoDBAdapter#client * @type {Object} */ self.client = new Promise(function (resolve, reject) { MongoClient.connect(opts.uri, function (err, db) { return err ? reject(err) : resolve(db) }) }) } // Setup prototype inheritance from Adapter MongoDBAdapter.prototype = Object.create(Adapter.prototype, { constructor: { value: MongoDBAdapter, enumerable: false, writable: true, configurable: true } }) Object.defineProperty(MongoDBAdapter, '__super__', { configurable: true, value: Adapter }) /** * Alternative to ES6 class syntax for extending `MongoDBAdapter`. * * @name MongoDBAdapter.extend * @method * @param {Object} [instanceProps] Properties that will be added to the * prototype of the MongoDBAdapter. * @param {Object} [classProps] Properties that will be added as static * properties to the MongoDBAdapter itself. * @return {Object} MongoDBAdapter of `MongoDBAdapter`. */ MongoDBAdapter.extend = extend addHiddenPropsToTarget(MongoDBAdapter.prototype, { /** * Translate ObjectIDs to strings. * * @name MongoDBAdapter#_translateId * @method * @return {*} */ _translateId (r, opts) { opts || (opts = {}) if (this.getOpt('translateId', opts)) { if (isArray(r)) { r.forEach(function (_r) { const __id = _r._id ? _r._id.toString() : _r._id _r._id = typeof __id === 'string' ? __id : _r._id }) } else if (isObject(r)) { const __id = r._id ? r._id.toString() : r._id r._id = typeof __id === 'string' ? __id : r._id } } return r }, /** * Return a Promise that resolves to a reference to the MongoDB client being * used by this adapter. * * Useful when you need to do anything custom with the MongoDB client library. * * @name MongoDBAdapter#getClient * @method * @return {Object} MongoDB client. */ getClient () { return this.client }, /** * Map filtering params in a selection query to MongoDB a filtering object. * * Handles the following: * * - where * - and bunch of filtering operators * * @name MongoDBAdapter#getQuery * @method * @return {Object} */ getQuery (mapper, query) { query = plainCopy(query || {}) query.where || (query.where = {}) forOwn(query, function (config, keyword) { if (reserved.indexOf(keyword) === -1) { if (isObject(config)) { query.where[keyword] = config } else { query.where[keyword] = { '==': config } } delete query[keyword] } }) let mongoQuery = {} if (Object.keys(query.where).length !== 0) { forOwn(query.where, function (criteria, field) { if (!isObject(criteria)) { query.where[field] = { '==': criteria } } forOwn(criteria, function (v, op) { if (op === '==' || op === '===' || op === 'contains') { mongoQuery[field] = v } else if (op === '!=' || op === '!==' || op === 'notContains') { mongoQuery[field] = mongoQuery[field] || {} mongoQuery[field].$ne = v } else if (op === '&gt;') { mongoQuery[field] = mongoQuery[field] || {} mongoQuery[field].$gt = v } else if (op === '&gt;=') { mongoQuery[field] = mongoQuery[field] || {} mongoQuery[field].$gte = v } else if (op === '&lt;') { mongoQuery[field] = mongoQuery[field] || {} mongoQuery[field].$lt = v } else if (op === '&lt;=') { mongoQuery[field] = mongoQuery[field] || {} mongoQuery[field].$lte = v } else if (op === 'in') { mongoQuery[field] = mongoQuery[field] || {} mongoQuery[field].$in = v } else if (op === 'notIn') { mongoQuery[field] = mongoQuery[field] || {} mongoQuery[field].$nin = v } else if (op === '|==' || op === '|===' || op === '|contains') { mongoQuery.$or = mongoQuery.$or || [] let orEqQuery = {} orEqQuery[field] = v mongoQuery.$or.push(orEqQuery) } else if (op === '|!=' || op === '|!==' || op === '|notContains') { mongoQuery.$or = mongoQuery.$or || [] let orNeQuery = {} orNeQuery[field] = { '$ne': v } mongoQuery.$or.push(orNeQuery) } else if (op === '|&gt;') { mongoQuery.$or = mongoQuery.$or || [] let orGtQuery = {} orGtQuery[field] = { '$gt': v } mongoQuery.$or.push(orGtQuery) } else if (op === '|&gt;=') { mongoQuery.$or = mongoQuery.$or || [] let orGteQuery = {} orGteQuery[field] = { '$gte': v } mongoQuery.$or.push(orGteQuery) } else if (op === '|&lt;') { mongoQuery.$or = mongoQuery.$or || [] let orLtQuery = {} orLtQuery[field] = { '$lt': v } mongoQuery.$or.push(orLtQuery) } else if (op === '|&lt;=') { mongoQuery.$or = mongoQuery.$or || [] let orLteQuery = {} orLteQuery[field] = { '$lte': v } mongoQuery.$or.push(orLteQuery) } else if (op === '|in') { mongoQuery.$or = mongoQuery.$or || [] let orInQuery = {} orInQuery[field] = { '$in': v } mongoQuery.$or.push(orInQuery) } else if (op === '|notIn') { mongoQuery.$or = mongoQuery.$or || [] let orNinQuery = {} orNinQuery[field] = { '$nin': v } mongoQuery.$or.push(orNinQuery) } }) }) } return mongoQuery }, /** * Map non-filtering params in a selection query to MongoDB query options. * * Handles the following: * * - limit * - skip/offset * - orderBy/sort * * @name MongoDBAdapter#getQueryOptions * @method * @return {Object} */ getQueryOptions (mapper, query) { query = plainCopy(query || {}) query.orderBy = query.orderBy || query.sort query.skip = query.skip || query.offset let queryOptions = {} if (query.orderBy) { if (isString(query.orderBy)) { query.orderBy = [ [query.orderBy, 'asc'] ] } for (var i = 0; i &lt; query.orderBy.length; i++) { if (isString(query.orderBy[i])) { query.orderBy[i] = [query.orderBy[i], 'asc'] } } queryOptions.sort = query.orderBy } if (query.skip) { queryOptions.skip = +query.skip } if (query.limit) { queryOptions.limit = +query.limit } return queryOptions }, /** * Turn an _id into an ObjectID if it isn't already an ObjectID. * * @name MongoDBAdapter#toObjectID * @method * @return {*} */ toObjectID (mapper, id) { if (id !== undefined &amp;&amp; mapper.idAttribute === '_id' &amp;&amp; typeof id === 'string' &amp;&amp; ObjectID.isValid(id) &amp;&amp; !(id instanceof ObjectID)) { return new ObjectID(id) } return id }, /** * Return the foreignKey from the given record for the provided relationship. * * @name MongoDBAdapter#makeBelongsToForeignKey * @method * @return {*} */ makeBelongsToForeignKey (mapper, def, record) { return this.toObjectID(def.getRelation(), Adapter.prototype.makeBelongsToForeignKey.call(this, mapper, def, record)) }, /** * Retrieve the record with the given primary key. * * @name MongoDBAdapter#find * @method * @param {Object} mapper The mapper. * @param {(string|number)} id Primary key of the record to retrieve. * @param {Object} [opts] Configuration options. * @param {Object} [opts.findOneOpts] Options to pass to collection#findOne. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {string[]} [opts.with=[]] Relations to eager load. * @return {Promise} */ find (mapper, id, opts) { const self = this let record, op opts || (opts = {}) opts.with || (opts.with = []) const findOneOpts = self.getOpt('findOneOpts', opts) findOneOpts.fields || (findOneOpts.fields = {}) return self.getClient().then(function (client) { // beforeFind lifecycle hook op = opts.op = 'beforeFind' return resolve(self[op](mapper, id, opts)).then(function () { return new Promise(function (resolve, reject) { let mongoQuery = {} mongoQuery[mapper.idAttribute] = self.toObjectID(mapper, id) client.collection(mapper.table || underscore(mapper.name)).findOne(mongoQuery, findOneOpts, function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }) }).then(function (_record) { if (!_record) { return } record = _record self._translateId(record, opts) const tasks = [] forEachRelation(mapper, opts, function (def, __opts) { const relatedMapper = def.getRelation() let task if (def.foreignKey &amp;&amp; (def.type === 'hasOne' || def.type === 'hasMany')) { if (def.type === 'hasOne') { task = self.loadHasOne(mapper, def, record, __opts) } else { task = self.loadHasMany(mapper, def, record, __opts) } } else if (def.type === 'hasMany' &amp;&amp; def.localKeys) { let localKeys = [] let itemKeys = get(record, def.localKeys) || [] itemKeys = isArray(itemKeys) ? itemKeys : Object.keys(itemKeys) localKeys = localKeys.concat(itemKeys) task = self.findAll(relatedMapper, { where: { [relatedMapper.idAttribute]: { 'in': unique(localKeys).filter(function (x) { return x }).map(function (x) { return self.toObjectID(relatedMapper, x) }) } } }, __opts).then(function (relatedItems) { def.setLocalField(record, relatedItems) }) } else if (def.type === 'hasMany' &amp;&amp; def.foreignKeys) { task = self.findAll(relatedMapper, { where: { [def.foreignKeys]: { 'contains': self.makeHasManyForeignKeys(mapper, def, record) } } }, __opts).then(function (relatedItems) { def.setLocalField(record, relatedItems) }) } else if (def.type === 'belongsTo') { task = self.loadBelongsTo(mapper, def, record, __opts) } if (task) { tasks.push(task) } }) return Promise.all(tasks) }).then(function () { let response = new Response(record, {}, 'find') response.found = record ? 1 : 0 response = self.respond(response, opts) // afterFind lifecycle hook op = opts.op = 'afterFind' return resolve(self[op](mapper, id, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }, /** * Retrieve the records that match the selection query. * * @name MongoDBAdapter#findAll * @method * @param {Object} mapper The mapper. * @param {Object} query Selection query. * @param {Object} [opts] Configuration options. * @param {Object} [opts.findOpts] Options to pass to collection#find. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {string[]} [opts.with=[]] Relations to eager load. * @return {Promise} */ findAll (mapper, query, opts) { const self = this opts || (opts = {}) opts.with || (opts.with = []) let records = [] let op const findOpts = self.getOpt('findOpts', opts) fillIn(findOpts, self.getQueryOptions(mapper, query)) findOpts.fields || (findOpts.fields = {}) const mongoQuery = self.getQuery(mapper, query) return self.getClient().then(function (client) { // beforeFindAll lifecycle hook op = opts.op = 'beforeFindAll' return resolve(self[op](mapper, query, opts)).then(function () { return new Promise(function (resolve, reject) { client.collection(mapper.table || underscore(mapper.name)).find(mongoQuery, findOpts).toArray(function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }) }).then(function (_records) { records = _records self._translateId(records, opts) const tasks = [] forEachRelation(mapper, opts, function (def, __opts) { const relatedMapper = def.getRelation() let task if (def.foreignKey &amp;&amp; (def.type === 'hasOne' || def.type === 'hasMany')) { if (def.type === 'hasMany') { task = self.loadHasMany(mapper, def, records, __opts) } else { task = self.loadHasOne(mapper, def, records, __opts) } } else if (def.type === 'hasMany' &amp;&amp; def.localKeys) { let localKeys = [] records.forEach(function (item) { let itemKeys = item[def.localKeys] || [] itemKeys = isArray(itemKeys) ? itemKeys : Object.keys(itemKeys) localKeys = localKeys.concat(itemKeys) }) task = self.findAll(relatedMapper, { where: { [relatedMapper.idAttribute]: { 'in': unique(localKeys).filter(function (x) { return x }).map(function (x) { return self.toObjectID(relatedMapper, x) }) } } }, __opts).then(function (relatedItems) { records.forEach(function (item) { let attached = [] let itemKeys = get(item, def.localKeys) || [] itemKeys = isArray(itemKeys) ? itemKeys : Object.keys(itemKeys) relatedItems.forEach(function (relatedItem) { if (itemKeys &amp;&amp; itemKeys.indexOf(relatedItem[relatedMapper.idAttribute]) !== -1) { attached.push(relatedItem) } }) def.setLocalField(item, attached) }) return relatedItems }) } else if (def.type === 'hasMany' &amp;&amp; def.foreignKeys) { throw new Error('findAll eager load hasMany foreignKeys not supported!') } else if (def.type === 'belongsTo') { task = self.loadBelongsTo(mapper, def, records, __opts) } if (task) { tasks.push(task) } }) return Promise.all(tasks) }).then(function () { records || (records = []) let response = new Response(records, {}, 'findAll') response.found = records.length response = self.respond(response, opts) // afterFindAll lifecycle hook op = opts.op = 'afterFindAll' return resolve(self[op](mapper, query, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }, /** * Create a new record. * * @name MongoDBAdapter#create * @method * @param {Object} mapper The mapper. * @param {Object} props The record to be created. * @param {Object} [opts] Configuration options. * @param {Object} [opts.insertOpts] Options to pass to collection#insert. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ create (mapper, props, opts) { const self = this let op props || (props = {}) opts || (opts = {}) const insertOpts = self.getOpt('insertOpts', opts) return self.getClient().then(function (client) { // beforeCreate lifecycle hook op = opts.op = 'beforeCreate' return resolve(self[op](mapper, props, opts)).then(function (_props) { // Allow for re-assignment from lifecycle hook props = isUndefined(_props) ? props : _props _props = withoutRelations(mapper, props) return new Promise(function (resolve, reject) { const collection = client.collection(mapper.table || underscore(mapper.name)) const method = collection.insertOne ? 'insertOne' : 'insert' collection[method](_props, insertOpts, function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }).then(function (cursor) { let record let r = cursor.ops ? cursor.ops : cursor self._translateId(r, opts) record = isArray(r) ? r[0] : r cursor.connection = undefined let response = new Response(record, cursor, 'create') response.created = record ? 1 : 0 response = self.respond(response, opts) // afterCreate lifecycle hook op = opts.op = 'afterCreate' return resolve(self[op](mapper, props, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }) }, /** * Create multiple records in a single batch. * * @name MongoDBAdapter#createMany * @method * @param {Object} mapper The mapper. * @param {Object} props The records to be created. * @param {Object} [opts] Configuration options. * @param {Object} [opts.insertManyOpts] Options to pass to * collection#insertMany. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @return {Promise} */ createMany (mapper, props, opts) { const self = this let op props || (props = {}) opts || (opts = {}) const insertManyOpts = self.getOpt('insertManyOpts', opts) return self.getClient().then(function (client) { // beforeCreateMany lifecycle hook op = opts.op = 'beforeCreateMany' return resolve(self[op](mapper, props, opts)).then(function (_props) { // Allow for re-assignment from lifecycle hook props = isUndefined(_props) ? props : _props _props = props.map(function (record) { return withoutRelations(mapper, record) }) return new Promise(function (resolve, reject) { const collection = client.collection(mapper.table || underscore(mapper.name)) collection.insertMany(_props, insertManyOpts, function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }).then(function (cursor) { let records = [] let r = cursor.ops ? cursor.ops : cursor self._translateId(r, opts) records = r cursor.connection = undefined let response = new Response(records, cursor, 'createMany') response.created = records.length response = self.respond(response, opts) // afterCreateMany lifecycle hook op = opts.op = 'afterCreateMany' return resolve(self[op](mapper, props, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }) }, /** * Destroy the record with the given primary key. * * @name MongoDBAdapter#destroy * @method * @param {Object} mapper The mapper. * @param {(string|number)} id Primary key of the record to destroy. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {Object} [opts.removeOpts] Options to pass to collection#remove. * @return {Promise} */ destroy (mapper, id, opts) { const self = this let op opts || (opts = {}) const removeOpts = self.getOpt('removeOpts', opts) return self.getClient().then(function (client) { // beforeDestroy lifecycle hook op = opts.op = 'beforeDestroy' return resolve(self[op](mapper, id, opts)).then(function () { return new Promise(function (resolve, reject) { const mongoQuery = {} mongoQuery[mapper.idAttribute] = self.toObjectID(mapper, id) const collection = client.collection(mapper.table || underscore(mapper.name)) collection[collection.deleteOne ? 'deleteOne' : 'remove'](mongoQuery, removeOpts, function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }) }).then(function (cursor) { cursor.connection = undefined let response = new Response(undefined, cursor, 'destroy') response = self.respond(response, opts) // afterDestroy lifecycle hook op = opts.op = 'afterDestroy' return resolve(self[op](mapper, id, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }, /** * Destroy the records that match the selection query. * * @name MongoDBAdapter#destroyAll * @method * @param {Object} mapper the mapper. * @param {Object} [query] Selection query. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {Object} [opts.removeOpts] Options to pass to collection#remove. * @return {Promise} */ destroyAll (mapper, query, opts) { const self = this let op query || (query = {}) opts || (opts = {}) const removeOpts = self.getOpt('removeOpts', opts) fillIn(removeOpts, self.getQueryOptions(mapper, query)) return self.getClient().then(function (client) { // beforeDestroyAll lifecycle hook op = opts.op = 'beforeDestroyAll' return resolve(self[op](mapper, query, opts)).then(function () { const mongoQuery = self.getQuery(mapper, query) return new Promise(function (resolve, reject) { const collection = client.collection(mapper.table || underscore(mapper.name)) collection[collection.deleteMany ? 'deleteMany' : 'remove'](mongoQuery, removeOpts, function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }) }).then(function (cursor) { cursor.connection = undefined let response = new Response(undefined, cursor, 'destroyAll') response = self.respond(response, opts) // afterDestroyAll lifecycle hook op = opts.op = 'afterDestroyAll' return resolve(self[op](mapper, query, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }, /** * Apply the given update to the record with the specified primary key. * * @name MongoDBAdapter#update * @method * @param {Object} mapper The mapper. * @param {(string|number)} id The primary key of the record to be updated. * @param {Object} props The update to apply to the record. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {Object} [opts.updateOpts] Options to pass to collection#update. * @return {Promise} */ update (mapper, id, props, opts) { const self = this props || (props = {}) opts || (opts = {}) let op const updateOpts = self.getOpt('updateOpts', opts) return self.find(mapper, id, { raw: false }).then(function (record) { if (!record) { throw new Error('Not Found') } // beforeUpdate lifecycle hook op = opts.op = 'beforeUpdate' return resolve(self[op](mapper, id, props, opts)) }).then(function (_props) { // Allow for re-assignment from lifecycle hook props = isUndefined(_props) ? props : _props _props = withoutRelations(mapper, props) return self.getClient().then(function (client) { return new Promise(function (resolve, reject) { const mongoQuery = {} mongoQuery[mapper.idAttribute] = self.toObjectID(mapper, id) const collection = client.collection(mapper.table || underscore(mapper.name)) collection[collection.updateOne ? 'updateOne' : 'update'](mongoQuery, { $set: _props }, updateOpts, function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }) }).then(function (cursor) { return self.find(mapper, id, { raw: false }).then(function (record) { cursor.connection = undefined let response = new Response(record, cursor, 'update') response.updated = 1 response = self.respond(response, opts) // afterUpdate lifecycle hook op = opts.op = 'afterUpdate' return resolve(self[op](mapper, id, props, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }) }, /** * Apply the given update to all records that match the selection query. * * @name MongoDBAdapter#updateAll * @method * @param {Object} mapper The mapper. * @param {Object} props The update to apply to the selected records. * @param {Object} [query] Selection query. * @param {Object} [opts] Configuration options. * @param {boolean} [opts.raw=false] Whether to return a more detailed * response object. * @param {Object} [opts.updateOpts] Options to pass to collection#update. * @return {Promise} */ updateAll (mapper, props, query, opts) { const self = this props || (props = {}) query || (query = {}) opts || (opts = {}) let op, ids const updateOpts = self.getOpt('updateOpts', opts) updateOpts.multi = true return self.getClient().then(function (client) { const queryOptions = self.getQueryOptions(mapper, query) const mongoQuery = self.getQuery(mapper, query) // beforeUpdateAll lifecycle hook op = opts.op = 'beforeUpdateAll' return resolve(self[op](mapper, props, query, opts)).then(function (_props) { // Allow for re-assignment from lifecycle hook props = isUndefined(_props) ? props : _props _props = withoutRelations(mapper, props) queryOptions.$set = _props return self.findAll(mapper, query, { raw: false }) }).then(function (records) { ids = records.map(function (record) { return self.toObjectID(mapper, record[mapper.idAttribute]) }) return new Promise(function (resolve, reject) { const collection = client.collection(mapper.table || underscore(mapper.name)) collection[collection.updateMany ? 'updateMany' : 'update'](mongoQuery, queryOptions, updateOpts, function (err, cursor) { return err ? reject(err) : resolve(cursor) }) }) }).then(function (cursor) { const query = {} query[mapper.idAttribute] = { 'in': ids } return self.findAll(mapper, query, { raw: false }).then(function (records) { cursor.connection = undefined let response = new Response(records, cursor, 'update') response.updated = records.length response = self.respond(response, opts) // afterUpdateAll lifecycle hook op = opts.op = 'afterUpdateAll' return resolve(self[op](mapper, props, query, opts, response)).then(function (_response) { // Allow for re-assignment from lifecycle hook return isUndefined(_response) ? response : _response }) }) }) }) }, /** * Not supported. * * @name MongoDBAdapter#updateMany * @method */ updateMany () { throw new Error('not supported!') } }) × Search results Close Back to js-data.io "},"global.html":{"id":"global.html","title":"Global","body":" js-data-mongodb Classes AdapterMongoDBAdapter Global Global Global Type Definitions Response Response object used when raw is true. May contain other fields in addition to data. Type: Object Properties: Name Type Description data Object Response data. op string The operation for which the response was created. Source: node_modules/js-data-adapter/src/index.js, line 58 × Search results Close Back to js-data.io "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" js-data-mongodb Classes AdapterMongoDBAdapter Global Global Classes Classes Adapter MongoDBAdapter × Search results Close Back to js-data.io "},"index.html":{"id":"index.html","title":"Index","body":" js-data-mongodb Classes AdapterMongoDBAdapter Global Global js-data-mongodb 1.0.0-alpha.4 js-data-mongodb MongoDB adapter for js-data. Table of contents Quick start Guides and Tutorials API Reference Docs Community Support Contributing License Quick Startnpm install --save js-data js-data-mongodb mongodb bson. // Use Container instead of DataStore on the server import {Container} from 'js-data' import MongoDBAdapter from 'js-data-mongodb' // Create a store to hold your Mappers const store = new Container({ mapperDefaults: { // MongoDB uses &quot;_id&quot; as the primary key idAttribute: '_id' } }) // Create an instance of MongoDBAdapter with default settings const adapter = new MongoDBAdapter() // Mappers in &quot;store&quot; will use the MongoDB adapter by default store.registerAdapter('mongodb', adapter, { default: true }) // Create a Mapper that maps to a &quot;user&quot; collection store.defineMapper('user')async function findAllAdminUsers () { // Find all users where &quot;user.role&quot; == &quot;admin&quot; return await store.findAll('user', { role: 'admin' }) }Guides and TutorialsGet started at http://js-data.io API Reference DocsVisit http://api.js-data.io. CommunityExplore the Community. SupportFind out how to Get Support. ContributingRead the Contributing Guide. LicenseThe MIT License (MIT) Copyright (c) 2014-2016 js-data-mongodb project authors LICENSE AUTHORS CONTRIBUTORS × Search results Close Back to js-data.io "},"Adapter.html":{"id":"Adapter.html","title":"Class: Adapter","body":" js-data-mongodb Classes AdapterMongoDBAdapter Global Global Class: Adapter Adapter &lt;abstract&gt; new Adapter(opts) Abstract class meant to be extended by adapters. Parameters: Name Type Argument Description opts Object &lt;optional&gt; Configuration opts. Properties Name Type Argument Default Description debug boolean &lt;optional&gt; false Whether to log debugging information. raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 74 Members debug :boolean Whether to log debugging information. Type: boolean Default Value: false Source: node_modules/js-data-adapter/src/index.js, line 39 raw :boolean Whether to return a more detailed response object. Type: boolean Default Value: false Source: node_modules/js-data-adapter/src/index.js, line 48 Methods &lt;static&gt; extend(instanceProps, classProps) Alternative to ES6 class syntax for extending Adapter. Parameters: Name Type Argument Description instanceProps Object &lt;optional&gt; Properties that will be added to the prototype of the subclass. classProps Object &lt;optional&gt; Properties that will be added as static properties to the subclass itself. Source: node_modules/js-data-adapter/src/index.js, line 91 Returns: Subclass of Adapter. Type Object afterCreate(mapper, props, opts, response) Lifecycle method method called by create. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes create to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the created record. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by create. Parameters: Name Type Description mapper Object The mapper argument passed to create. props Object The props argument passed to create. opts Object The opts argument passed to create. response Object | Response Created record or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterCreate Source: node_modules/js-data-adapter/src/index.js, line 105 afterCreate(mapper, props, opts, response) Lifecycle method method called by createMany. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes createMany to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the created records. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by createMany. Parameters: Name Type Description mapper Object The mapper argument passed to createMany. props Array.&lt;Object&gt; The props argument passed to createMany. opts Object The opts argument passed to createMany. response Array.&lt;Object&gt; | Response Created records or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterCreateMany Source: node_modules/js-data-adapter/src/index.js, line 128 afterDestroy(mapper, id, opts, response) Lifecycle method method called by destroy. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroy to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be undefined. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroy. Parameters: Name Type Description mapper Object The mapper argument passed to destroy. id string | number The id argument passed to destroy. opts Object The opts argument passed to destroy. response undefined | Response undefined or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterDestroy Source: node_modules/js-data-adapter/src/index.js, line 151 afterDestroyAll(mapper, query, opts, response) Lifecycle method method called by destroyAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroyAll to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be undefined. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroyAll. Parameters: Name Type Description mapper Object The mapper argument passed to destroyAll. query Object The query argument passed to destroyAll. opts Object The opts argument passed to destroyAll. response undefined | Response undefined or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterDestroyAll Source: node_modules/js-data-adapter/src/index.js, line 174 afterFind(mapper, id, opts, response) Lifecycle method method called by find. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes find to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the found record, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by find. Parameters: Name Type Description mapper Object The mapper argument passed to find. id string | number The id argument passed to find. opts Object The opts argument passed to find. response Object | Response The found record or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterFind Source: node_modules/js-data-adapter/src/index.js, line 197 afterFindAll(mapper, query, opts, response) Lifecycle method method called by findAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes findAll to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the found records, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by findAll. Parameters: Name Type Description mapper Object The mapper argument passed to findAll. query Object The query argument passed to findAll. opts Object The opts argument passed to findAll. response Array.&lt;Object&gt; | Response The found records or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterFindAll Source: node_modules/js-data-adapter/src/index.js, line 220 afterUpdate(mapper, id, props, opts, response) Lifecycle method method called by update. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes update to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the updated record. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by update. Parameters: Name Type Description mapper Object The mapper argument passed to update. id string | number The id argument passed to update. props Object The props argument passed to update. opts Object The opts argument passed to update. response Object | Response The updated record or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterUpdate Source: node_modules/js-data-adapter/src/index.js, line 243 afterUpdateAll(mapper, props, query, opts, response) Lifecycle method method called by updateAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateAll to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the updated records, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateAll. Parameters: Name Type Description mapper Object The mapper argument passed to updateAll. props Object The props argument passed to updateAll. query Object The query argument passed to updateAll. opts Object The opts argument passed to updateAll. response Array.&lt;Object&gt; | Response The updated records or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterUpdateAll Source: node_modules/js-data-adapter/src/index.js, line 267 afterUpdateMany(mapper, records, opts, response) Lifecycle method method called by updateMany. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateMany to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the updated records, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateMany. Parameters: Name Type Description mapper Object The mapper argument passed to updateMany. records Array.&lt;Object&gt; The records argument passed to updateMany. opts Object The opts argument passed to updateMany. response Array.&lt;Object&gt; | Response The updated records or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterUpdateMany Source: node_modules/js-data-adapter/src/index.js, line 291 beforeCreate(mapper, props, opts) Lifecycle method method called by create. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes create to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by create. Parameters: Name Type Description mapper Object The mapper argument passed to create. props Object The props argument passed to create. opts Object The opts argument passed to create. Properties: Name Type Description opts.op string beforeCreate Source: node_modules/js-data-adapter/src/index.js, line 314 beforeCreateMany(mapper, props, opts) Lifecycle method method called by createMany. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes createMany to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by createMany. Parameters: Name Type Description mapper Object The mapper argument passed to createMany. props Array.&lt;Object&gt; The props argument passed to createMany. opts Object The opts argument passed to createMany. Properties: Name Type Description opts.op string beforeCreateMany Source: node_modules/js-data-adapter/src/index.js, line 334 beforeDestroy(mapper, id, opts) Lifecycle method method called by destroy. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroy to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroy. Parameters: Name Type Description mapper Object The mapper argument passed to destroy. id string | number The id argument passed to destroy. opts Object The opts argument passed to destroy. Properties: Name Type Description opts.op string beforeDestroy Source: node_modules/js-data-adapter/src/index.js, line 354 beforeDestroyAll(mapper, query, opts) Lifecycle method method called by destroyAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroyAll to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroyAll. Parameters: Name Type Description mapper Object The mapper argument passed to destroyAll. query Object The query argument passed to destroyAll. opts Object The opts argument passed to destroyAll. Properties: Name Type Description opts.op string beforeDestroyAll Source: node_modules/js-data-adapter/src/index.js, line 372 beforeFind(mapper, id, opts) Lifecycle method method called by find. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes find to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by find. Parameters: Name Type Description mapper Object The mapper argument passed to find. id string | number The id argument passed to find. opts Object The opts argument passed to find. Properties: Name Type Description opts.op string beforeFind Source: node_modules/js-data-adapter/src/index.js, line 390 beforeFindAll(mapper, query, opts) Lifecycle method method called by findAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes findAll to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by findAll. Parameters: Name Type Description mapper Object The mapper argument passed to findAll. query Object The query argument passed to findAll. opts Object The opts argument passed to findAll. Properties: Name Type Description opts.op string beforeFindAll Source: node_modules/js-data-adapter/src/index.js, line 408 beforeUpdate(mapper, id, props, opts) Lifecycle method method called by update. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes update to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by update. Parameters: Name Type Description mapper Object The mapper argument passed to update. id string | number The id argument passed to update. props Object The props argument passed to update. opts Object The opts argument passed to update. Properties: Name Type Description opts.op string beforeUpdate Source: node_modules/js-data-adapter/src/index.js, line 426 beforeUpdateAll(mapper, props, query, opts) Lifecycle method method called by updateAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateAll to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateAll. Parameters: Name Type Description mapper Object The mapper argument passed to updateAll. props Object The props argument passed to updateAll. query Object The query argument passed to updateAll. opts Object The opts argument passed to updateAll. Properties: Name Type Description opts.op string beforeUpdateAll Source: node_modules/js-data-adapter/src/index.js, line 447 beforeUpdateMany(mapper, props, opts) Lifecycle method method called by updateMany. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateMany to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateMany. Parameters: Name Type Description mapper Object The mapper argument passed to updateMany. props Array.&lt;Object&gt; The props argument passed to updateMany. opts Object The opts argument passed to updateMany. Properties: Name Type Description opts.op string beforeUpdateMany Source: node_modules/js-data-adapter/src/index.js, line 468 create(mapper, props, opts) Create a new record. Called by Mapper#create. Parameters: Name Type Argument Description mapper Object The mapper. props Object The record to be created. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 498 Returns: Type Promise createMany(mapper, props, opts) Create multiple records in a single batch. Called by Mapper#createMany. Parameters: Name Type Argument Description mapper Object The mapper. props Object The records to be created. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 514 Returns: Type Promise dbg() Shortcut for #log('debug'[, arg1[, arg2[, argn]]]). Source: node_modules/js-data-adapter/src/index.js, line 488 destroy(mapper, id, opts) Destroy the record with the given primary key. Called by Mapper#destroy. Parameters: Name Type Argument Description mapper Object The mapper. id string | number Primary key of the record to destroy. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 530 Returns: Type Promise destroyAll(mapper, query, opts) Destroy the records that match the selection query. Called by Mapper#destroyAll. Parameters: Name Type Argument Description mapper Object the mapper. query Object &lt;optional&gt; Selection query. Properties Name Type Argument Description where Object &lt;optional&gt; Filtering criteria. orderBy string | Array &lt;optional&gt; Sorting criteria. sort string | Array &lt;optional&gt; Same as query.sort. limit number &lt;optional&gt; Limit results. skip number &lt;optional&gt; Offset results. offset number &lt;optional&gt; Same as query.skip. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 547 Returns: Type Promise find(mapper, id, opts) Retrieve the record with the given primary key. Called by Mapper#find. Parameters: Name Type Argument Description mapper Object The mapper. id string | number Primary key of the record to retrieve. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. with Array.&lt;string&gt; &lt;optional&gt; [] Relations to eager load. Source: node_modules/js-data-adapter/src/index.js, line 725 Returns: Type Promise findAll(mapper, query, opts) Retrieve the records that match the selection query. Parameters: Name Type Argument Description mapper Object The mapper. query Object &lt;optional&gt; Selection query. Properties Name Type Argument Description where Object &lt;optional&gt; Filtering criteria. orderBy string | Array &lt;optional&gt; Sorting criteria. sort string | Array &lt;optional&gt; Same as query.sort. limit number &lt;optional&gt; Limit results. skip number &lt;optional&gt; Offset results. offset number &lt;optional&gt; Same as query.skip. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. with Array.&lt;string&gt; &lt;optional&gt; [] Relations to eager load. Source: node_modules/js-data-adapter/src/index.js, line 742 Returns: Type Promise getOpt(opt, opts) Resolve the value of the specified option based on the given options and this adapter's settings. Override with care. Parameters: Name Type Argument Description opt string The name of the option. opts Object &lt;optional&gt; Configuration options. Source: node_modules/js-data-adapter/src/index.js, line 765 Returns: The value of the specified option. Type * loadBelongsTo() Load a belongsTo relationship. Override with care. Source: node_modules/js-data-adapter/src/index.js, line 683 Returns: Type Promise loadHasMany() Load a hasMany relationship. Override with care. Source: node_modules/js-data-adapter/src/index.js, line 599 Returns: Type Promise loadHasOne() Load a hasOne relationship. Override with care. Source: node_modules/js-data-adapter/src/index.js, line 647 Returns: Type Promise log(level, values) Logging utility method. Override this method if you want to send log messages to something other than the console. Parameters: Name Type Argument Description level string Log level. values * &lt;repeatable&gt; Values to log. Source: node_modules/js-data-adapter/src/index.js, line 780 makeBelongsToForeignKey() Return the foreignKey from the given record for the provided relationship. Override with care. Source: node_modules/js-data-adapter/src/index.js, line 670 Returns: Type * makeHasManyForeignKey() Return the foreignKey from the given record for the provided relationship. There may be reasons why you may want to override this method, like when the id of the parent doesn't exactly match up to the key on the child. Override with care. Source: node_modules/js-data-adapter/src/index.js, line 570 Returns: Type * makeHasManyForeignKeys() Return the foreignKeys from the given record for the provided relationship. Override with care. Source: node_modules/js-data-adapter/src/index.js, line 586 Returns: Type * respond(response, opts) Parameters: Name Type Description response Object Response object. opts Object Configuration options. return {Object} If opts.raw == true then return response, else return response.data. Source: node_modules/js-data-adapter/src/index.js, line 805 update(mapper, id, props, opts) Apply the given update to the record with the specified primary key. Called by Mapper#update. Parameters: Name Type Argument Description mapper Object The mapper. id string | number The primary key of the record to be updated. props Object The update to apply to the record. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 817 Returns: Type Promise updateAll(mapper, props, query, opts) Apply the given update to all records that match the selection query. Called by Mapper#updateAll. Parameters: Name Type Argument Description mapper Object The mapper. props Object The update to apply to the selected records. query Object &lt;optional&gt; Selection query. Properties Name Type Argument Description where Object &lt;optional&gt; Filtering criteria. orderBy string | Array &lt;optional&gt; Sorting criteria. sort string | Array &lt;optional&gt; Same as query.sort. limit number &lt;optional&gt; Limit results. skip number &lt;optional&gt; Offset results. offset number &lt;optional&gt; Same as query.skip. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 835 Returns: Type Promise updateMany(mapper, records, opts) Update the given records in a single batch. Called by Mapper#updateMany. Parameters: Name Type Argument Description mapper Object The mapper. records Array.&lt;Object&gt; The records to update. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Source: node_modules/js-data-adapter/src/index.js, line 859 Returns: Type Promise × Search results Close Back to js-data.io "},"MongoDBAdapter.html":{"id":"MongoDBAdapter.html","title":"Class: MongoDBAdapter","body":" js-data-mongodb Classes AdapterMongoDBAdapter Global Global Class: MongoDBAdapter MongoDBAdapter new MongoDBAdapter(opts) MongoDBAdapter class. Parameters: Name Type Argument Description opts Object &lt;optional&gt; Configuration opts. Properties Name Type Argument Default Description debug boolean &lt;optional&gt; false Whether to log debugging information. findOpts Object &lt;optional&gt; Options to pass to collection#find. findOneOpts Object &lt;optional&gt; Options to pass to collection#findOne. insertOpts Object &lt;optional&gt; Options to pass to collection#insert. insertManyOpts Object &lt;optional&gt; Options to pass to collection#insertMany. raw boolean &lt;optional&gt; false Whether to return detailed result objects instead of just record data. removeOpts Object &lt;optional&gt; Options to pass to collection#remove. translateId boolean &lt;optional&gt; true Convert ObjectIDs to strings when pulling records out of the database. updateOpts Object &lt;optional&gt; Options to pass to collection#update. uri string &lt;optional&gt; &quot;mongodb://localhost:27017&quot; MongoDB URI. Source: src/index.js, line 60 Example // Use Container instead of DataStore on the server import {Container} from 'js-data' import MongoDBAdapter from 'js-data-mongodb' // Create a store to hold your Mappers const store = new Container({ mapperDefaults: { // MongoDB uses &quot;_id&quot; as the primary key idAttribute: '_id' } }) // Create an instance of MongoDBAdapter with default settings const adapter = new MongoDBAdapter() // Mappers in &quot;store&quot; will use the MongoDB adapter by default store.registerAdapter('mongodb', adapter, { default: true }) // Create a Mapper that maps to a &quot;user&quot; collection store.defineMapper('user') Extends Adapter Members client :Object A Promise that resolves to a reference to the MongoDB client being used by this adapter. Type: Object Source: src/index.js, line 172 debug :boolean Whether to log debugging information. Type: boolean Inherited From: Adapter#debug Default Value: false Source: node_modules/js-data-adapter/src/index.js, line 39 findOneOpts :Object Default options to pass to collection#findOne. Type: Object Default Value: {} Source: src/index.js, line 122 findOpts :Object Default options to pass to collection#find. Type: Object Default Value: {} Source: src/index.js, line 112 insertManyOpts :Object Default options to pass to collection#insertMany. Type: Object Default Value: {} Source: src/index.js, line 142 insertOpts :Object Default options to pass to collection#insert. Type: Object Default Value: {} Source: src/index.js, line 132 raw :boolean Whether to return a more detailed response object. Type: boolean Inherited From: Adapter#raw Default Value: false Source: node_modules/js-data-adapter/src/index.js, line 48 removeOpts :Object Default options to pass to collection#update. Type: Object Default Value: {} Source: src/index.js, line 162 translateId :boolean Convert ObjectIDs to strings when pulling records out of the database. Type: boolean Default Value: true Source: src/index.js, line 34 updateOpts :Object Default options to pass to collection#update. Type: Object Default Value: {} Source: src/index.js, line 152 uri :string MongoDB URI. Type: string Default Value: mongodb://localhost:27017 Source: src/index.js, line 43 Methods &lt;static&gt; extend(instanceProps, classProps) Alternative to ES6 class syntax for extending MongoDBAdapter. Parameters: Name Type Argument Description instanceProps Object &lt;optional&gt; Properties that will be added to the prototype of the MongoDBAdapter. classProps Object &lt;optional&gt; Properties that will be added as static properties to the MongoDBAdapter itself. Source: src/index.js, line 201 Returns: MongoDBAdapter of MongoDBAdapter. Type Object _translateId() Translate ObjectIDs to strings. Source: src/index.js, line 215 Returns: Type * afterCreate(mapper, props, opts, response) Lifecycle method method called by create. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes create to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the created record. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by create. Parameters: Name Type Description mapper Object The mapper argument passed to create. props Object The props argument passed to create. opts Object The opts argument passed to create. response Object | Response Created record or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterCreate Inherited From: Adapter#afterCreate Overrides: Adapter#afterCreate Source: node_modules/js-data-adapter/src/index.js, line 105 afterDestroy(mapper, id, opts, response) Lifecycle method method called by destroy. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroy to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be undefined. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroy. Parameters: Name Type Description mapper Object The mapper argument passed to destroy. id string | number The id argument passed to destroy. opts Object The opts argument passed to destroy. response undefined | Response undefined or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterDestroy Inherited From: Adapter#afterDestroy Source: node_modules/js-data-adapter/src/index.js, line 151 afterDestroyAll(mapper, query, opts, response) Lifecycle method method called by destroyAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroyAll to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be undefined. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroyAll. Parameters: Name Type Description mapper Object The mapper argument passed to destroyAll. query Object The query argument passed to destroyAll. opts Object The opts argument passed to destroyAll. response undefined | Response undefined or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterDestroyAll Inherited From: Adapter#afterDestroyAll Source: node_modules/js-data-adapter/src/index.js, line 174 afterFind(mapper, id, opts, response) Lifecycle method method called by find. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes find to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the found record, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by find. Parameters: Name Type Description mapper Object The mapper argument passed to find. id string | number The id argument passed to find. opts Object The opts argument passed to find. response Object | Response The found record or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterFind Inherited From: Adapter#afterFind Source: node_modules/js-data-adapter/src/index.js, line 197 afterFindAll(mapper, query, opts, response) Lifecycle method method called by findAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes findAll to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the found records, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by findAll. Parameters: Name Type Description mapper Object The mapper argument passed to findAll. query Object The query argument passed to findAll. opts Object The opts argument passed to findAll. response Array.&lt;Object&gt; | Response The found records or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterFindAll Inherited From: Adapter#afterFindAll Source: node_modules/js-data-adapter/src/index.js, line 220 afterUpdate(mapper, id, props, opts, response) Lifecycle method method called by update. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes update to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the updated record. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by update. Parameters: Name Type Description mapper Object The mapper argument passed to update. id string | number The id argument passed to update. props Object The props argument passed to update. opts Object The opts argument passed to update. response Object | Response The updated record or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterUpdate Inherited From: Adapter#afterUpdate Source: node_modules/js-data-adapter/src/index.js, line 243 afterUpdateAll(mapper, props, query, opts, response) Lifecycle method method called by updateAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateAll to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the updated records, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateAll. Parameters: Name Type Description mapper Object The mapper argument passed to updateAll. props Object The props argument passed to updateAll. query Object The query argument passed to updateAll. opts Object The opts argument passed to updateAll. response Array.&lt;Object&gt; | Response The updated records or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterUpdateAll Inherited From: Adapter#afterUpdateAll Source: node_modules/js-data-adapter/src/index.js, line 267 afterUpdateMany(mapper, records, opts, response) Lifecycle method method called by updateMany. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateMany to wait for the Promise to resolve before continuing. If opts.raw is true then response will be a detailed response object, otherwise response will be the updated records, if any. response may be modified. You can also re-assign response to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateMany. Parameters: Name Type Description mapper Object The mapper argument passed to updateMany. records Array.&lt;Object&gt; The records argument passed to updateMany. opts Object The opts argument passed to updateMany. response Array.&lt;Object&gt; | Response The updated records or Response, depending on the value of opts.raw. Properties: Name Type Description opts.op string afterUpdateMany Inherited From: Adapter#afterUpdateMany Source: node_modules/js-data-adapter/src/index.js, line 291 beforeCreate(mapper, props, opts) Lifecycle method method called by create. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes create to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by create. Parameters: Name Type Description mapper Object The mapper argument passed to create. props Object The props argument passed to create. opts Object The opts argument passed to create. Properties: Name Type Description opts.op string beforeCreate Inherited From: Adapter#beforeCreate Source: node_modules/js-data-adapter/src/index.js, line 314 beforeCreateMany(mapper, props, opts) Lifecycle method method called by createMany. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes createMany to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by createMany. Parameters: Name Type Description mapper Object The mapper argument passed to createMany. props Array.&lt;Object&gt; The props argument passed to createMany. opts Object The opts argument passed to createMany. Properties: Name Type Description opts.op string beforeCreateMany Inherited From: Adapter#beforeCreateMany Source: node_modules/js-data-adapter/src/index.js, line 334 beforeDestroy(mapper, id, opts) Lifecycle method method called by destroy. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroy to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroy. Parameters: Name Type Description mapper Object The mapper argument passed to destroy. id string | number The id argument passed to destroy. opts Object The opts argument passed to destroy. Properties: Name Type Description opts.op string beforeDestroy Inherited From: Adapter#beforeDestroy Source: node_modules/js-data-adapter/src/index.js, line 354 beforeDestroyAll(mapper, query, opts) Lifecycle method method called by destroyAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes destroyAll to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by destroyAll. Parameters: Name Type Description mapper Object The mapper argument passed to destroyAll. query Object The query argument passed to destroyAll. opts Object The opts argument passed to destroyAll. Properties: Name Type Description opts.op string beforeDestroyAll Inherited From: Adapter#beforeDestroyAll Source: node_modules/js-data-adapter/src/index.js, line 372 beforeFind(mapper, id, opts) Lifecycle method method called by find. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes find to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by find. Parameters: Name Type Description mapper Object The mapper argument passed to find. id string | number The id argument passed to find. opts Object The opts argument passed to find. Properties: Name Type Description opts.op string beforeFind Inherited From: Adapter#beforeFind Source: node_modules/js-data-adapter/src/index.js, line 390 beforeFindAll(mapper, query, opts) Lifecycle method method called by findAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes findAll to wait for the Promise to resolve before continuing. A thrown error or rejected Promise will bubble up and reject the Promise returned by findAll. Parameters: Name Type Description mapper Object The mapper argument passed to findAll. query Object The query argument passed to findAll. opts Object The opts argument passed to findAll. Properties: Name Type Description opts.op string beforeFindAll Inherited From: Adapter#beforeFindAll Source: node_modules/js-data-adapter/src/index.js, line 408 beforeUpdate(mapper, id, props, opts) Lifecycle method method called by update. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes update to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by update. Parameters: Name Type Description mapper Object The mapper argument passed to update. id string | number The id argument passed to update. props Object The props argument passed to update. opts Object The opts argument passed to update. Properties: Name Type Description opts.op string beforeUpdate Inherited From: Adapter#beforeUpdate Source: node_modules/js-data-adapter/src/index.js, line 426 beforeUpdateAll(mapper, props, query, opts) Lifecycle method method called by updateAll. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateAll to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateAll. Parameters: Name Type Description mapper Object The mapper argument passed to updateAll. props Object The props argument passed to updateAll. query Object The query argument passed to updateAll. opts Object The opts argument passed to updateAll. Properties: Name Type Description opts.op string beforeUpdateAll Inherited From: Adapter#beforeUpdateAll Source: node_modules/js-data-adapter/src/index.js, line 447 beforeUpdateMany(mapper, props, opts) Lifecycle method method called by updateMany. Override this method to add custom behavior for this lifecycle hook. Returning a Promise causes updateMany to wait for the Promise to resolve before continuing. props may be modified. You can also re-assign props to another value by returning a different value or a Promise that resolves to a different value. A thrown error or rejected Promise will bubble up and reject the Promise returned by updateMany. Parameters: Name Type Description mapper Object The mapper argument passed to updateMany. props Array.&lt;Object&gt; The props argument passed to updateMany. opts Object The opts argument passed to updateMany. Properties: Name Type Description opts.op string beforeUpdateMany Inherited From: Adapter#beforeUpdateMany Source: node_modules/js-data-adapter/src/index.js, line 468 create(mapper, props, opts) Create a new record. Parameters: Name Type Argument Description mapper Object The mapper. props Object The record to be created. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description insertOpts Object &lt;optional&gt; Options to pass to collection#insert. raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Overrides: Adapter#create Source: src/index.js, line 647 Returns: Type Promise createMany(mapper, props, opts) Create multiple records in a single batch. Parameters: Name Type Argument Description mapper Object The mapper. props Object The records to be created. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description insertManyOpts Object &lt;optional&gt; Options to pass to collection#insertMany. raw boolean &lt;optional&gt; false Whether to return a more detailed response object. Overrides: Adapter#createMany Source: src/index.js, line 702 Returns: Type Promise dbg() Shortcut for #log('debug'[, arg1[, arg2[, argn]]]). Inherited From: Adapter#dbg Source: node_modules/js-data-adapter/src/index.js, line 488 destroy(mapper, id, opts) Destroy the record with the given primary key. Parameters: Name Type Argument Description mapper Object The mapper. id string | number Primary key of the record to destroy. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. removeOpts Object &lt;optional&gt; Options to pass to collection#remove. Overrides: Adapter#destroy Source: src/index.js, line 759 Returns: Type Promise destroyAll(mapper, query, opts) Destroy the records that match the selection query. Parameters: Name Type Argument Description mapper Object the mapper. query Object &lt;optional&gt; Selection query. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. removeOpts Object &lt;optional&gt; Options to pass to collection#remove. Overrides: Adapter#destroyAll Source: src/index.js, line 805 Returns: Type Promise find(mapper, id, opts) Retrieve the record with the given primary key. Parameters: Name Type Argument Description mapper Object The mapper. id string | number Primary key of the record to retrieve. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description findOneOpts Object &lt;optional&gt; Options to pass to collection#findOne. raw boolean &lt;optional&gt; false Whether to return a more detailed response object. with Array.&lt;string&gt; &lt;optional&gt; [] Relations to eager load. Overrides: Adapter#find Source: src/index.js, line 446 Returns: Type Promise findAll(mapper, query, opts) Retrieve the records that match the selection query. Parameters: Name Type Argument Description mapper Object The mapper. query Object Selection query. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description findOpts Object &lt;optional&gt; Options to pass to collection#find. raw boolean &lt;optional&gt; false Whether to return a more detailed response object. with Array.&lt;string&gt; &lt;optional&gt; [] Relations to eager load. Overrides: Adapter#findAll Source: src/index.js, line 546 Returns: Type Promise getClient() Return a Promise that resolves to a reference to the MongoDB client being used by this adapter. Useful when you need to do anything custom with the MongoDB client library. Source: src/index.js, line 238 Returns: MongoDB client. Type Object getOpt(opt, opts) Resolve the value of the specified option based on the given options and this adapter's settings. Override with care. Parameters: Name Type Argument Description opt string The name of the option. opts Object &lt;optional&gt; Configuration options. Inherited From: Adapter#getOpt Source: node_modules/js-data-adapter/src/index.js, line 765 Returns: The value of the specified option. Type * getQuery() Map filtering params in a selection query to MongoDB a filtering object. Handles the following: where and bunch of filtering operators Source: src/index.js, line 252 Returns: Type Object getQueryOptions() Map non-filtering params in a selection query to MongoDB query options. Handles the following: limit skip/offset orderBy/sort Source: src/index.js, line 376 Returns: Type Object loadBelongsTo() Load a belongsTo relationship. Override with care. Inherited From: Adapter#loadBelongsTo Source: node_modules/js-data-adapter/src/index.js, line 683 Returns: Type Promise loadHasMany() Load a hasMany relationship. Override with care. Inherited From: Adapter#loadHasMany Source: node_modules/js-data-adapter/src/index.js, line 599 Returns: Type Promise loadHasOne() Load a hasOne relationship. Override with care. Inherited From: Adapter#loadHasOne Source: node_modules/js-data-adapter/src/index.js, line 647 Returns: Type Promise log(level, values) Logging utility method. Override this method if you want to send log messages to something other than the console. Parameters: Name Type Argument Description level string Log level. values * &lt;repeatable&gt; Values to log. Inherited From: Adapter#log Source: node_modules/js-data-adapter/src/index.js, line 780 makeBelongsToForeignKey() Return the foreignKey from the given record for the provided relationship. Overrides: Adapter#makeBelongsToForeignKey Source: src/index.js, line 435 Returns: Type * makeHasManyForeignKey() Return the foreignKey from the given record for the provided relationship. There may be reasons why you may want to override this method, like when the id of the parent doesn't exactly match up to the key on the child. Override with care. Inherited From: Adapter#makeHasManyForeignKey Source: node_modules/js-data-adapter/src/index.js, line 570 Returns: Type * makeHasManyForeignKeys() Return the foreignKeys from the given record for the provided relationship. Override with care. Inherited From: Adapter#makeHasManyForeignKeys Source: node_modules/js-data-adapter/src/index.js, line 586 Returns: Type * respond(response, opts) Parameters: Name Type Description response Object Response object. opts Object Configuration options. return {Object} If opts.raw == true then return response, else return response.data. Inherited From: Adapter#respond Source: node_modules/js-data-adapter/src/index.js, line 805 toObjectID() Turn an _id into an ObjectID if it isn't already an ObjectID. Source: src/index.js, line 421 Returns: Type * update(mapper, id, props, opts) Apply the given update to the record with the specified primary key. Parameters: Name Type Argument Description mapper Object The mapper. id string | number The primary key of the record to be updated. props Object The update to apply to the record. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. updateOpts Object &lt;optional&gt; Options to pass to collection#update. Overrides: Adapter#update Source: src/index.js, line 852 Returns: Type Promise updateAll(mapper, props, query, opts) Apply the given update to all records that match the selection query. Parameters: Name Type Argument Description mapper Object The mapper. props Object The update to apply to the selected records. query Object &lt;optional&gt; Selection query. opts Object &lt;optional&gt; Configuration options. Properties Name Type Argument Default Description raw boolean &lt;optional&gt; false Whether to return a more detailed response object. updateOpts Object &lt;optional&gt; Options to pass to collection#update. Overrides: Adapter#updateAll Source: src/index.js, line 911 Returns: Type Promise updateMany() Not supported. Overrides: Adapter#updateMany Source: src/index.js, line 979 × Search results Close Back to js-data.io "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
